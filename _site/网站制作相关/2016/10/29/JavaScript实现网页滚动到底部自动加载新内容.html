<h1 id="javascript实现网页滚动到底部自动加载新内容">JavaScript实现网页滚动到底部自动加载新内容</h1>

<p>实现效果如图<a href="https://raw.githubusercontent.com/ankanch/blog/master/images/wp-content/uploads/2016/10/QQ截图20161029143852.png"><img src="https://raw.githubusercontent.com/ankanch/blog/master/images/wp-content/uploads/2016/10/QQ截图20161029143852.png" alt="QQ&#x622A;&#x56FE;20161029143852" /></a></p>

<p>当网页滚动到底部的时候，自动加载更多评论。</p>

<p>JavaScript的实现逻辑非常简单，就是判断滚动条的滚动长度是否和网页长度一样了。</p>

<p>其JS代码如下：</p>

<p>var p = 1; var page_num = 2;</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                function loadComments() {
                    var tid = document.getElementById("tid").innerHTML;
                    var commentsbaseurl = "/getcomments/"
                    commentsbaseurl = commentsbaseurl + tid + "/" + p + "/";
                    p += 5
                    $.get(commentsbaseurl, function(data) {
                        if (data != "NULL") {
                            document.getElementById("commentslist").innerHTML = document.getElementById("commentslist").innerHTML + data;
                        } else {
                            $.snackbar({
                                content: "评论已经全部拉取完毕！如果你刚刚提交了评论，请不要着急，评论刷新存在延迟。"
                            });
                        }
                    });
                }
                $(document).ready(function() {
                    $(window).scroll(function() {
                        if ($(document).scrollTop() &amp;gt;= $(document).height() - $(window).height()) {
                            var div1tem = $('#container').height()

                            loadComments()
                        }
                    })
                })&lt;/pre&gt;
</code></pre></div></div>

<p>你们只需要自定义loadComments(）函数即可实现，当网页滚动到底部的时候加载更多内容。</p>

<p>即通过JavaScript获取新内容放到以个&lt;div&gt;&lt;/div&gt;里即可。</p>

<p>已知bug：</p>

<p>如果用户的分辨率太大，浏览器没有滚动条出现，那么此方法就会失效。</p>

<p>一个可能的解决办法是，再加一个按钮，来实现手动加载。</p>

