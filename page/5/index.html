<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="personal blog of Long Zhang (kanchisme@gmail.com)">
<meta property="og:type" content="website">
<meta property="og:title" content="akakanch">
<meta property="og:url" content="http://akakanch.com/page/5/index.html">
<meta property="og:site_name" content="akakanch">
<meta property="og:description" content="personal blog of Long Zhang (kanchisme@gmail.com)">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="akakanch">
<meta name="twitter:description" content="personal blog of Long Zhang (kanchisme@gmail.com)">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://akakanch.com/page/5/"/>





  <title>akakanch</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">akakanch</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            Über
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://akakanch.com/2015/12/29/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kanch">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="akakanch">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/12/29/" itemprop="url">几个C++数字转字符串（int转string）函数与其复杂度比较</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-29T13:06:53+08:00">
                2015-12-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/" itemprop="url" rel="index">
                    <span itemprop="name">C++ / Visual C++</span>
                  </a>
                </span>

                
                
                  . 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/算法、/" itemprop="url" rel="index">
                    <span itemprop="name">算法、</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;</p>
<p>前几天在做一道ACM题的时候，这道题要求我们对输入的2个数字逆序相加，再将它们的和逆序输出。当时我直接调用了itoa函数进行数字到字符串的转换，再用我之前的AddNum函数进行加法运算。结果上传到BNUOJ上后，居然编译错误。提示：</p>
<pre id="dcontent" class="">error: 'itoa' was not declared in this scope</pre>
后来无奈只有自己实现这个函数。数字转字符串之前在C语言课上我写过一个。不过，这次我想到了一个特别的方法。下面来详细说说这几个方法吧。

* * *

&nbsp;

## 方法一

首先，先来谈谈我最早在C语言上的方法：

之前我都这样做，每次用这个数去除以小于它的10^n数，再利用C/C++ int类型取整的特性，来得到要转换数字的每个数位。

比如，对于4567这个数字，我先用1000去除，得到第一个数位4；再用100除它，得到的数字X减去之前得到的数字乘以10，就得到第二个数位5；同理，再继续将4567除以10，得到数再减去之前得到的中间数乘以10，就得到第三个数位6，再用同样的方法得到第4个数位。

最后，整个算法是这个样子的：
<pre class="lang:c++ decode:true ">void itoc(long n,char * num)
{
    int len=0, p=n;
    while(p/=10)
    {
        len++;
    }
    len++;
    for(p=0;p&lt;len;p++)
    {
        int x=1;
        for(int t=p+1;t&lt;len;t++)
        {
            x*=10;
        }
        num[p] = n/x + '0';
        n -=( num[p] - '0' ) * x;
    }
    num[len] = '\0';
}</pre>
&nbsp;

## 方法二

其次，我们来谈谈这次我的方法：

原理很简单，我们不做除法，不是完全不做，我们一直做减法就行。比如还是对于4567这个数字，首先，我们知道的是：4567和10求余肯定不为0。所以我们就一直让4567减1，直到4567和10求余余数为0就停止。然后我们再将现在的这个数字，也就是4560除10，得到456，再用同样的方法，依次递减1，直到450为止，从而得到第二个数位6，依次这样做下去，我们就可以得到第3，第4个数位了。

最后，整个算法是这个样子的：
<pre class="lang:c++ decode:true">inline string inttostr(int num)
{
    int buf=num,x=0;
    string snum="";
    while(1)
    {
        //if(buf==1)
        if(buf&lt;10)
        {
            char ch=buf+'0';
            snum+=ch;
            break;
        }
        else if(buf%10)
        {
            buf--;
            x++;
        }
        else if(!(buf%10) &amp;&amp; buf !=0)
        {
            char ch=x+'0';
            snum+=ch;
            buf /= 10;
            x=0;
        }
    }

    return snum;
}
</pre>

<p>## </p>
<h2 id="系统的方法"><a href="#系统的方法" class="headerlink" title="系统的方法"></a>系统的方法</h2><p>再看看系统，不对，是某某库的itoa方法：</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/12/itoa_1.jpg" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/12/itoa_1.jpg" alt="itoa_1"></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>stdlib.h库里函数的方法用了和方法一原理上相同的方法，只不过，好吧，他这个可以判断正负。写得好简洁。</p>
<p>&nbsp;</p>
<hr>
<p>几种方法的效率分析：</p>
<p>我们用这三个算法进行50000次int到str的转换，结果如下：</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/12/inttostr.png" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/12/inttostr.png" alt="inttostr"></a></p>
<p>什么鬼这是，我的新方法居然慢了这么多，，，，悲剧了。</p>
<p>可以看到，传统方法和标准库里面的方法在速度上没太大的区别。新方法呢，，，的确，慢了好多。</p>
<p>&nbsp;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://akakanch.com/2015/12/09/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kanch">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="akakanch">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/12/09/" itemprop="url">高精度计算详解（加法）与其C++实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-09T01:07:45+08:00">
                2015-12-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/" itemprop="url" rel="index">
                    <span itemprop="name">C++ / Visual C++</span>
                  </a>
                </span>

                
                
                  . 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/算法、/" itemprop="url" rel="index">
                    <span itemprop="name">算法、</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这个源于<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1002" target="_blank" rel="noopener">一道ACM题</a>，显示在<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1002" target="_blank" rel="noopener">杭电OJ</a>上面看到了计算2个15位数字的和，咋一看，以为很简单，结果被坑惨了。后面在自己学校的题里面看到了输出斐波拉契数列的前1000项，我查了查第1000项，卧槽，真的好长。</p>
<p>斐波拉契数列第1000项：43466557686937456435688527675040625802564660517371780402481729089536555417949051890403879840079255169295922593080322634775209689623239873322471161642996440906533187938298969649928516003704476137795166849228875</p>
<p>要想计算输出这些的话，用那些编程语言自带的数据类型肯定不行，所以这里就自然想到了分别处理这个数字的每一位，当然，还有更优的方法是，分别处理数列的每几位。我们这里就讨论把数字的每一位提取出来进行处理吧。</p>
<p>来自百度百科：对于非常庞大的数字无法在计算机中正常存储，于是，将这个数字拆开，拆成一位一位的，或者是四位四位的存储到一个数组中， 用一个数组去表示一个数字，这样这个数字就被称为是高精度数。</p>
<p>当然，这里给出<a href="https://zh.wikipedia.org/wiki/%E9%AB%98%E7%B2%BE%E5%BA%A6%E8%AE%A1%E7%AE%97" target="_blank" rel="noopener">维基百科，高精度计算页面</a></p>
<p>因为我这里只是简单的讨论高精度计算，所以这里 只讨论最简单的，即高精度加法，至于乘法和除法，我会在以后补上。</p>
<p>先来从一张图看看高精度计算中的加法：</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/12/highdef_com.png" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/12/highdef_com.png" alt="highdef_com"></a></p>
<p>所以，要实现高精度计算，我指的是加法，我们只需要实现以下2点：</p>
<ol>
<li>把一个数字的每一位单独储存</li>
<li>对数字的每一位相加，手工进位<br>再来讲讲如何单独储存数字的每一位。有2种方法，第一种当然是按照正常的顺序，</li>
</ol>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/12/highdef_com_11.jpg" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/12/highdef_com_11.jpg" alt="highdef_com_1"></a></p>
<p>&nbsp;</p>
<p>大家可以从上图清晰的看到，采用第二种方法储存数位，最便于我们编写代码进行表达与相加。</p>
<p>所以，若采用第二种方法，我们就可以把每次每个数位的相加表达成以下方法：</p>
<p><pre class="lang:c++ decode:true">rebuf[i] = nabuf[i] + nbbuf[i]+ X;<br> X = rebuf[i]/10;<br>rebuf[i] = rebuf[i]%10;</pre><br>注意，每次相加除了要加上2个数相应的数位，我们还应该加上上一次低位相加后产生的进位。上面代码中，rebuf储存了相加的结果，nabuf是储存数字A的每一个数位的数组，同理，nbbuf是储存数字B每一个数位的数组，而X则是每次相加后的进位。</p>
<p>另外，因为我们采取了方法二来储存，缺点就是，我们在传入2个数字后要对其进行反转，然后计算完毕后，再反转回来。</p>
<p>这里就有一个小问题：如果数字A或者B是100000这种，反转后就变成000001，相加后结果可能会出现 000000100这种情况，再将结果反转就变成了001000000。</p>
<p>所以，我们还需要一段代码处理这个结果，把前面的0都去掉，当然，如果存在的话。毕竟我们需要的只是相加后的结果。</p>
<p><pre class="lang:c++ decode:true ">    X=1;<br>    for(int i=loop;i&gt;=0;i–)<br>    {<br>        if(rebuf[i]==0 &amp;&amp; X==1)<br>        {<br>            continue;<br>        }<br>        X = 0;<br>        result  += (rebuf[i] + ‘0’);<br>    }</pre><br>这里运用了类似状态机的原理，当遇到第一个非0值的时候，我们对于其后的每一个数字都加到结果字符串result中。否则我们句略过当前值，即0。</p>
<p>最终它的代码，我是指这个大数相加的函数代码如下：</p>
<p><pre class="lang:c++ decode:true ">string AddNum(string &amp;na,string &amp;nb)<br>{<br>    int rebuf[1001]={0},nabuf[1001]={0},nbbuf[1001]={0};<br>    int X=0,nalen=na.length(),nblen=nb.length(),loop = nalen;<br>    if(nalen &lt; nblen)<br>    {<br>        loop = nblen;</pre></p>
<pre><code>}
for(int i=nalen-1;i&amp;gt;=0;i--)
{
    nabuf[nalen - 1 - i] = na[i] - &apos;0&apos;;
}
for(int i=nblen-1;i&amp;gt;=0;i--)
{
    nbbuf[nblen - 1 - i] = nb[i] - &apos;0&apos;;
}
//start cal
for(int i=0;i&amp;lt;loop;i++)
{
    rebuf[i] = nabuf[i] + nbbuf[i]+ X;
    X = rebuf[i]/10;
    rebuf[i] = rebuf[i]%10;
}
rebuf[loop] +=X;
//to string
string result=&quot;&quot;;
X=1;
for(int i=loop;i&amp;gt;=0;i--)
{
    if(rebuf[i]==0 &amp;amp;&amp;amp; X==1)
    {
        continue;
    }
    X = 0;
    result  += (rebuf[i] + &apos;0&apos;);
}
return result;
</code></pre><p>}<br><br>这里我们只讨论了加法，减法和加法类似。</p>
<p>乘法和除法我大概会在以后补出来。</p>
<p>xD</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://akakanch.com/2015/11/21/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kanch">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="akakanch">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/21/" itemprop="url">C语言实现给定16进制转换成10进制以及相关细节优化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-21T19:21:52+08:00">
                2015-11-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/" itemprop="url" rel="index">
                    <span itemprop="name">C++ / Visual C++</span>
                  </a>
                </span>

                
                
                  . 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/算法、/" itemprop="url" rel="index">
                    <span itemprop="name">算法、</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>好吧，这个其实是某某书上的一道习题，刚开始看的时候我还以为可以直接输入0xFFF的形式同时赋值给int类型来进行转换，结果，结果发现我想多了。所以，我决定来写篇文章谈谈这个算法。好吧，下面进入正题。</p>
<p>首先说说我们的转换原理，当然是<a href="https://www.google.com.hk/search?q=%E9%99%A4K%E5%8F%96%E4%BD%99%E6%B3%95&amp;oq=%E9%99%A4K%E5%8F%96%E4%BD%99%E6%B3%95&amp;gs_l=serp.3..35i39.1950.3477.0.3661.3.3.0.0.0.0.357.357.3-1.1.0....0...1c.1.64.serp..2.1.356.j45CD7vYAcw" target="_blank" rel="noopener">基于除K取余法</a>的逆运算。</p>
<p>比如，我们现有16进制数据 0xFFF  <em>（16进制：1,2,….A,B…F，其中A=10，F=15）</em></p>
<p>按照除K取余法的逆运算，我们有：</p>
<p><strong>0xFFF</strong> = <span style="color: #800000;">15<em>(16^2) + 15</em>(16^1) + 15*(16^0)</span> = 4095</p>
<p><strong>0x12A</strong> =  <span style="color: #800000;">1<em>(16^2) + 2</em>(16^1) + 10*(16^0)</span> = 298</p>
<hr>
<p>&nbsp;</p>
<p>程序的具体实现：</p>
<p>我在文章开头提到，我之前想的是<del>直接用scanf()输入一个16进制数字，再赋值给int即可</del>，后来，我试了直接输入FFF或者是输入0xFFF发现都不行，最后突然想到，原来自己忘记了scanf的%d只接受数字，所以。</p>
<p>我们要自己写函数转换，就需要接受一个字符串型的16进制数据。然后再用循环依次处理字符串中的每一个字符。</p>
<p>在写的过程中了，最早想的是针对每一个字符我用if块或switch-case来实现判断不同的字符和分别对它们进行不同的处理。不过后来又想了想，这种方法难免会让代码很长。</p>
<p>所以，后来查<a href="https://en.wikipedia.org/wiki/ASCII" target="_blank" rel="noopener">ASCII表</a>的，想到，我可以利用加减法来判断是那个字符。方法如下：</p>
<p>我们要分2种情况：字符属于‘0’—‘9’和字符属于‘A’—‘F’或‘a’—‘f’的情况。</p>
<p>然后，查<a href="https://en.wikipedia.org/wiki/ASCII" target="_blank" rel="noopener">ASCII表</a>知：‘A’=65，‘a’=97，‘0’=48</p>
<p>所以，接下来我们要判断当前处理字符是哪个就会变得非常简单，不用if块或switch-case哦。</p>
<p><pre class="lang:c decode:true">                if ((hex[i]&gt;=’A’ &amp;&amp; hex[i]&lt;=’F’) || (hex[i]&gt;=’a’&amp;&amp;hex[i]&lt;=’f’))<br>        {<br>            if (hex[i] &gt;= ‘A’ &amp;&amp; hex[i] &lt;= ‘F’)   //A=65,<br>            {<br>                for (p = 1; p &lt; len; p++)<br>                {<br>                    buf <em>= 16;<br>                }<br>                dec += (ch-55)</em>buf;       /// //看懂了吧<br>            }<br>            else    //a=97,<br>            {<br>                for (p = 1; p &lt; len; p++)<br>                {<br>                    buf <em>= 16;<br>                }<br>                dec += (ch - 87)</em>buf;    //看懂了吧<br>            }<br>        }</pre><br>注意看我打了注释的代码，这样的代码是不是非常简洁，比用很多if或者switch简洁多了:)</p>
<p><pre class="lang:c decode:true">dec += (ch-55)*buf;</pre><br><span style="color: #ff00ff;">我们拿A举例，在实际判断中我们其实是不需要知道这个字符具体是什么值，我们的目的就是将它化成10进制，A在16进制中代表10，而A在ASCII码中的值为65，那么，若char X = ‘A’的话，就有 A - t =10，就得到t=55，剩下的对于每个在’A’—‘F’之间的16进制数字，我们只需要令它减去55就得到对应代表的数字了。</span></p>
<p>当然，这里的不用if块指的是判断单个字符上，但是我们仍然需要用if保证当前处理字符在16进制中合法。</p>
<hr>
<p>&nbsp;</p>
<p>下面是完整代码：</p>
<p><pre class="lang:c decode:true ">#include&lt;stdio.h&gt;</pre></p>
<p>#include&lt;string.h&gt;</p>
<p>int Hex2Dec(char<em> hex)<br>{<br>    int dec = 0, i = 0, len = 0, buf = 0, p = 0;<br>    char ch = 0;<br>    while (hex[len])<br>    {<br>        len++;<br>    }<br>    while (hex[i])<br>    {<br>        ch = hex[i];<br>        buf = 1;<br>        if ((hex[i]&gt;=’A’ &amp;&amp; hex[i]&lt;=’F’) || (hex[i]&gt;=’a’&amp;&amp;hex[i]&lt;=’f’))<br>        {<br>            if (hex[i] &gt;= ‘A’ &amp;&amp; hex[i] &lt;= ‘F’)   //A=65,<br>            {<br>                for (p = 1; p &lt; len; p++)<br>                {<br>                    buf </em>= 16;<br>                }<br>                dec += (ch-55)<em>buf;<br>            }<br>            else if(hex[i] &gt;= ‘a’&amp;&amp;hex[i] &lt;= ‘f’)   //a=97,<br>            {<br>                for (p = 1; p &lt; len; p++)<br>                {<br>                    buf </em>= 16;<br>                }<br>                dec += (ch - 87)<em>buf;<br>            }<br>        }<br>        else if(hex[i] &gt;=’0’ &amp;&amp; hex[i]&lt;=’9’)   //0=48,<br>        {<br>            for (p = 1; p &lt; len; p++)<br>            {<br>                buf </em>= 16;<br>            }<br>            dec += (ch - 48)*buf;<br>        }<br>        else<br>        {<br>            printf(“nninvaild data input!nn”);<br>            return 0;<br>        }<br>        i++;<br>        len–;<br>    }</p>
<pre><code>return dec;
</code></pre><p>}</p>
<p>int main()<br>{<br>    char hex[99] = { 0 };<br>    printf(“please enter a Hex number:”);<br>    gets(hex);<br>    printf(“its equal to %dnn”, Hex2Dec(hex));<br>    return 0;<br>}<br><br>运行结果：和计算器算出来的一模一样</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/11/16_c_2.jpg" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/11/16_c_2.jpg" alt="16_c_2"></a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://akakanch.com/2015/11/16/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kanch">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="akakanch">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/16/" itemprop="url">C语言实现螺旋矩阵输出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-16T22:57:20+08:00">
                2015-11-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/" itemprop="url" rel="index">
                    <span itemprop="name">C++ / Visual C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>上周的C语言实验课，有一道选做题，叫我们输出n*n（n&lt;15）的<span style="color: #ff6600;">螺旋矩阵</span>，就像这样矩阵：</p>
<p>一个5*5的螺旋矩阵：</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/11/sm_print_1.png" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/11/sm_print_1.png" alt="sm_print_1"></a></p>
<p><span style="color: #ff6600;">这里的讨论的矩阵比较特殊，因为是n<em>n的而不是n</em>j的</span>。初看这个题觉得挺简单的，但实际上做的时候还是费了些时间。</p>
<hr>
<p>这里先讨论第一种方法吧，第二种方法在未来我会补上。</p>
<hr>
<p>&nbsp;</p>
<h2 id="法一："><a href="#法一：" class="headerlink" title="法一："></a>法一：</h2><p>第一种方法基本思路是：<span style="color: #993300;">在一个大的循环里分别用4个内嵌循环控制矩阵顶部行，右侧列，底部行，左侧列的输出。</span></p>
<p>同时，我们要意识到，<span style="color: #993300;">在输出n为偶数或者n为奇数的对应螺旋矩阵的时候，最后一点会有些不同</span>，具体请看下面2张图：</p>
<p>（左侧为n=4，右侧为n=5）</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/11/sm_print_2.png" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/11/sm_print_2.png" alt="sm_print_2"></a><a href="http://139.129.6.122/wp-content/uploads/2015/11/sm_print_1.png" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/11/sm_print_1.png" alt="sm_print_1"></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>不难发现，在n为偶数的时候，最后一点循环那里，会把4个方向（顶部，底部，左边，右边）都循环一边。而当n为奇数的时候，最后一点那里，只有最中间一个数字了。所以针对这种情况，我们的解决方案是：当n为偶数的时候，最外层循环循环<span style="color: #ff6600;">n<em>n</em></span>次，当n为奇数的时候，最外层循环循环<span style="color: #ff6600;">nn-1</span>次，并在最后，将最中间的那个数字（坐标为<span style="color: #ff6600;">x=y=(n-1)/2</span>）赋值为n*n。</p>
<p><pre class="lang:c++ decode:true">        //用来根据n是偶数还是奇数来决定最外层循环次数<br>        if (n % 2 == 0)<br>    {<br>        loops = n<em>n;<br>    }<br>    else if (n % 2 != 0)<br>    {<br>        loops = n</em>n - 1;<br>    }<br>    //now start to fill the arrary<br>        …..此处代码省略…..<br>    //如果n为奇数，我们就单独设置最中间的值<br>    if (n % 2 != 0)<br>    {<br>        spi[(n - 1) / 2][(n - 1) / 2] = n<em>n;<br>    }</em></pre><br>最主要，也是最关键的地方在于我们如何保证这里在顶部行输出后切换到右侧列，然后底部行，左侧列，再顶部行。对此，我用了一种比较笨的方法，（更棒的方法在未来会贴出，是用状态机），在一个循环nn次或者n*n-1次的大循环里面，写4个小循环，分别来控制顶部行，右侧列，底部行，左侧列的输出。</p>
<p>循环输出螺旋矩阵的核心代码大概是这样的：</p>
<p><pre class="lang:c++ decode:true ">       //now start to fill the arrary<br>       //rtop当前顶部行的位置，cright当前右侧列的位置，其它的我想我不用解释了<br>    for ( i = 1; i &lt;= loops; )<br>    {<br>        posp–;   //这个变量针对底部行，左侧列的输出控制<br>        //for the top-like raw<br>        rtop++;<br>        for ( j = rtop; j &lt; (xp+rtop); j++)<br>        {<br>            spi[rtop][j] = i;<br>            i++;<br>            //printf(“%d “, spi[rtop][j]);<br>        }</pre></p>
<pre><code>    //printf(&quot;n&quot;);
    if (i &amp;gt; loops)
    {
        break;
    }

    //for the right-like column
    cright--;
    for ( j = rtop; j &amp;lt; (xp+rtop); j++)   
    {
        spi[j][cright] = i;
        i++;
        //printf(&quot;%d &quot;, spi[j][cright]);
    }

    //printf(&quot;n&quot;);
    if (i &amp;gt; loops)
    {
        break;
    }

    //for the buttom-like raw
    rbuttom--;
    pb = posp;
    for (j = xp; j &amp;gt;0; j--)
    {
        spi[rbuttom][pb] = i;
        i++;
        pb--;
        //printf(&quot;%d &quot;, spi[rbuttom][j]);
    }

    //printf(&quot;n&quot;);
    if (i &amp;gt; loops)
    {
        break;
    }

    //for the left-like raw
    cleft++;
    pb = posp;
    for (j =xp; j &amp;gt;0; j--)
    {
        spi[pb][cleft] = i;
        i++;
        pb--;
        //printf(&quot;%d &quot;, spi[j][cleft]);
    }

    //printf(&quot;n&quot;);
    if (i &amp;gt; loops)
    {
        break;
    }

    //back-all processions
    xp -= 2;   //这个是记录每次输出多少个数字的
}&lt;/pre&gt;
</code></pre><p>&nbsp;</p>
<hr>
<p>&nbsp;</p>
<p>这里就留给将来更新第二种方法—-使用向量机的方式。最近学业繁重，恐怕是没时间了:(</p>
<hr>
<p>&lt;kanch@11/16/2015@CUIT&gt;</p>
<p>&nbsp;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://akakanch.com/2015/11/08/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kanch">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="akakanch">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/08/" itemprop="url">关于ASP.NET获得访问者IP的问题。得到的IP地址不准确！与解决办法。</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-08T18:10:19+08:00">
                2015-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/网站制作相关/" itemprop="url" rel="index">
                    <span itemprop="name">网站制作相关</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;</p>
<p>前段时间，大概在7月份的时候，我做了一个工具网站，其中有一项功能是获得访问者IP地址及根据IP地址来查询访问者的ISP及地区。当时弄了很久，都没弄出啥来，我指的是获得的IP地址不准确。后来我继续Google解决方案，终于把它给解决了。之后就再也没管了，渐渐忘了这个。</p>
<p>直到前几天，我收到了一封邮件，内容里说道他也遇到了这个问题，在<a href="http://bbs.csdn.net/topics/391064934" target="_blank" rel="noopener">CSDN上找到了我之前的帖子</a>，看我已经解决了这个问题，所以想知道我是怎么解决的。（我去，当时我也是在网上找到的解决方案，再加上过去了这么久了，我咋会知道）好吧，不过我还是决定来理一理这个问题。下面进入正题。</p>
<p><em>所有代码均为C#，.NetFramework4.0</em></p>
<hr>
<h2 id="先来说说之前那个版本吧"><a href="#先来说说之前那个版本吧" class="headerlink" title="先来说说之前那个版本吧"></a>先来说说之前那个版本吧</h2><p>下面这个可以获得IP，但是，，不准确 -_-</p>
<p><pre class="lang:c# decode:true ">public static string GetIP()<br>    {<br>        string result = String.Empty;<br>        result = HttpContext.Current.Request.ServerVariables[“HTTP_X_FORWARDED_FOR”];<br>        if (string.IsNullOrEmpty(result))<br>        {<br>            result = HttpContext.Current.Request.ServerVariables[“REMOTE_ADDR”];<br>        }<br>        if(string.IsNullOrEmpty(result))<br>        {<br>            result = HttpContext.Current.Request.UserHostAddress;<br>        }<br>        if(string.IsNullOrEmpty(result))<br>        {<br>            return “127.0.0.1”;<br>        }<br>        return result;<br>    }</pre><br>下面是结果：</p>
<p>&lt;这个是在我的网站上得到的结果&gt;</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/11/asp_get_ip_1.jpg" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/11/asp_get_ip_1.jpg" alt="asp_get_ip_1"></a></p>
<p>&lt;这个是在腾讯IP分享计划网站上得到的结果&gt;</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/11/asp_get_ip_1.jpg" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/11/asp_get_ip_3.jpg" alt="asp_get_ip_3"></a></p>
<p>&lt;这个是在GetMyIP网站上得到的结果&gt;</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/11/asp_get_ip_2.jpg" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/11/asp_get_ip_2.jpg" alt="asp_get_ip_2"></a></p>
<p>下面来讲讲这个版本：</p>
<p><em><span style="color: #003300;">这个版本是利用HTTP Header来获得IP地址的。假设Header里面包含的真实IP，那先默认它为真实IP，</span></em></p>
<p>_<span style="color: #003300;">但是如果包含X_FORWARDED_FOR则说明用户使用了代理，那就把X_FORWARDED_FOR作为用户真实IP。如果两者都没有，就取REMOTE_ADDR作为用户真实IP。</span>_</p>
<p>_<span style="color: #003300;">因为当使用者通过代理服务器时，REMOTE_ADDR会显示为代理服务器的IP。部分代理服务器会将使用者的原始真实IP放在客户端的IP或的X转发，对于在header中传递，这样就可以取得真实IP。</span>_</p>
<ul>
<li>我先用了<em><span style="color: #ffcc99;">HttpContext</span></em>中的<em><span style="color: #ffcc99;">request</span></em>的_<span style="color: #ffcc99;">HTTP_X_FORWARDED_FOR</span>_变量来判断用户是否使用了代理<br><strong><span style="color: #ff00ff;">HttpContext</span></strong>封装了有关个别 HTTP 请求的所有 HTTP 特定的信息。</li>
</ul>
<p><strong><span style="color: #ff00ff;">Current</span></strong>则是表示为当前HTTP请求设置对象</p>
<p><span style="color: #ff00ff;"><strong>SerVaeribles[]</strong></span>则是一系列服务器变量的集合，对于详细的属性，你们可以看这里，这里有  个<a href="http://www.cnblogs.com/zwffff/archive/2009/04/18/1438567.html" target="_blank" rel="noopener"><strong><span lang="EN-US">Server.Variables</span>**</strong>属性大全**</a></p>
<ul>
<li><p>再简单的用了<em><span style="color: #ffcc99;">HttpContext</span></em>中request的_<span style="color: #ffcc99;">REMOTE_ADDR</span>_变量来获得用户的IP<br><strong><span style="color: #ff00ff;">REMOTE_ADDR</span></strong>即获得用户真实IP</p>
</li>
<li><p>再通过<em><span style="color: #ffcc99;">HttpContext</span></em>中request的<span style="color: #ffcc99;">UserHostAddress</span>来得到IP<br><strong><span style="color: #ff00ff;">UserHostAddress</span></strong>是用来获取远程客户端的 IP 主机地址。</p>
</li>
</ul>
<p>要是以上都不满足，就说明用户/服务器在本地，IP自然就是127.0.0.1了</p>
<hr>
<h2 id="为什么获得的IP会不一样呢？"><a href="#为什么获得的IP会不一样呢？" class="headerlink" title="为什么获得的IP会不一样呢？"></a>为什么获得的IP会不一样呢？</h2><p>我在网上查了很久，大概是这样的：</p>
<p><span style="color: #000000;"><a href="http://devco.re/blog/2014/06/19/client-ip-detection/" target="_blank" rel="noopener">「<strong>任何從客戶端取得的資料都是不可信任的！</strong>」</a></span></p>
<p>其实我也没搞懂什么意思。。。大概是说你PC上的某些安全软件或者浏览器会修改head数据吧</p>
<hr>
<h2 id="这是修改之后的版本："><a href="#这是修改之后的版本：" class="headerlink" title="这是修改之后的版本："></a>这是修改之后的版本：</h2><p><pre class="lang:c++ decode:true">protected String GetUser_IP()<br>    {<br>        string VisitorsIPAddr = string.Empty;<br>        if (HttpContext.Current.Request.ServerVariables[“HTTP_X_FORWARDED_FOR”] != null)<br>        {<br>            VisitorsIPAddr = HttpContext.Current.Request.ServerVariables[“HTTP_X_FORWARDED_FOR”].ToString();<br>        }<br>        else if (HttpContext.Current.Request.UserHostAddress.Length != 0)<br>        {<br>            VisitorsIPAddr = HttpContext.Current.Request.UserHostAddress;<br>        }<br>        return  VisitorsIPAddr;<br>    }</pre><br>在调用的服务器变量上没有什么特别的变化。</p>
<p>但是我们的确获得了真实IP：</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/11/asp_get_ip_41.jpg" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/11/asp_get_ip_41.jpg" alt="asp_get_ip_4"></a></p>
<p>P.S.写这篇文章的时候我正在成都读书-_-</p>
<hr>
<h3 id="再来谈谈如何根据用户IP获得其地理位置和ISP吧。"><a href="#再来谈谈如何根据用户IP获得其地理位置和ISP吧。" class="headerlink" title="再来谈谈如何根据用户IP获得其地理位置和ISP吧。"></a>再来谈谈如何根据用户IP获得其地理位置和ISP吧。</h3><p>这个嘛，我利用了淘宝IP库的API，我只需要通过WebAPI将要查询的IP传给淘宝，然后淘宝就会以JSON数据格式，把对应IP说的ISP提供商和地理位置信息回传给我。</p>
<p><a href="http://ip.taobao.com/instructions.php" target="_blank" rel="noopener">淘宝WebAPI参考：http://ip.taobao.com/instructions.php</a></p>
<p>返回的数据像这样：</p>
<p><pre class="lang:r decode:true ">{“code”:0,”data”:{“ip”:”210.75.225.254”,”country”:”u4e2du56fd”,”area”:”u534eu5317”,<br>“region”:”u5317u4eacu5e02”,”city”:”u5317u4eacu5e02”,”county”:””,”isp”:”u7535u4fe1”,<br>“country_id”:”86”,”area_id”:”100000”,”region_id”:”110000”,”city_id”:”110000”,<br>“county_id”:”-1”,”isp_id”:”100017”}}</pre><br>&nbsp;</p>
<p>所以，我写了个通过IP得到相关信息的函数</p>
<p><pre class="lang:c# decode:true">   public static string GetUserLocation(string IPaddr)                //根据IP地址获得用户所在区域<br>    {<br>        try<br>        {<br>            WebClient webGetting = new WebClient();<br>            string userIP = IPaddr;<br>            string ipQueryResult = webGetting.DownloadString(“<a href="http://ip.taobao.com/service/getIpInfo.php?ip=&quot;" target="_blank" rel="noopener">http://ip.taobao.com/service/getIpInfo.php?ip=&quot;</a> + userIP);<br>            return ipQueryResult;<br>        }<br>        catch<br>        {<br>            return string.Empty;<br>        }<br>    }</pre><br>&nbsp;</p>
<hr>
<p>文章参考了<em><a href="http://devco.re/blog/2014/06/19/client-ip-detection/" target="_blank" rel="noopener">如何正確的取得使用者 IP？</a></em></p>
<p>&nbsp;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://akakanch.com/2015/11/03/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kanch">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="akakanch">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/03/" itemprop="url">C语言证明哥德巴赫猜想算法以及算法优化相关问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-03T22:32:39+08:00">
                2015-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/" itemprop="url" rel="index">
                    <span itemprop="name">C++ / Visual C++</span>
                  </a>
                </span>

                
                
                  . 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/算法、/" itemprop="url" rel="index">
                    <span itemprop="name">算法、</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;</p>
<p>上周，我们C语言老师给我们布置了一道小组作业：用C语言编写程序，证明哥德巴赫猜想在4—1000,000之间成立。最后成绩以各组算法在他机器上运行时间为准。特别注意：只能使用《C语言程序设计》前五章的知识，即不能用指针，不能用数组，不能用自定义函数等等…</p>
<p>我们才学C语言没多久，就布置这样的题目？跪了。不过大体想了想，要证明哥德巴赫猜在4—1000,000之间成立，其实还是简单的，关键是如何优化算法，让它的时间最短。</p>
<p>首先我们先来熟悉下<a href="https://zh.wikipedia.org/wiki/%E5%93%A5%E5%BE%B7%E5%B7%B4%E8%B5%AB%E7%8C%9C%E6%83%B3" target="_blank" rel="noopener">哥德巴赫猜想</a>：哥德巴赫猜想主张每个大于等于4的偶数都是<strong>哥德巴赫数</strong>——可表示成两个<a href="https://zh.wikipedia.org/wiki/%E7%B4%A0%E6%95%B0" target="_blank" rel="noopener">素数</a>之和的数。</p>
<h3 id="基本思路"><a href="#基本思路" class="headerlink" title="基本思路"></a>基本思路</h3><p>来说说基本解题思路：对于任意给定偶数a，我们要先把它拆分成x和y，并满足x+y=a。然后循环判断x与y都为<a href="https://zh.wikipedia.org/wiki/%E7%B4%A0%E6%95%B0" target="_blank" rel="noopener">质数</a>即可。</p>
<p>所以就有了如下代码：</p>
<p><pre class="lang:c decode:true">#include&lt;stdio.h&gt;</pre></p>
<p>#include&lt;time.h&gt;</p>
<p>#include&lt;math.h&gt;</p>
<p>int main()<br>{<br>    clock_t s, f;<br>    int x = 4, m, n, t = 2, r = 0,T=0,R=0;<br>    s = clock();<br>    //process start<br>    //第一个循环，用来取出4——1000000之间的，所有偶数x<br>    for (; x &lt; 1000000; x+=2)<br>    {<br>        m = x / 2;<br>        n = m;<br>        R = m;<br>        //这个循环，用来对取出的偶数x的分解出的2个数做x/2次判断因为m和n变到0和x都需x/2次自减自加<br>        for (r = 0; r &lt; R; r++, m–, n++)<br>        {<br>            T = sqrt(n);<br>            //这个循环用来判断偶数x分解出的2个数m，n是否为质数，因为 n&gt;=m 恒成立，所以我们做sqrt(n)次判断<br>            for (t = 2; t &lt; T; t++)<br>            {<br>                //如果n和m中有一个数能够被大于2的整数i整除，则跳出这个for循环，对m，n变换后继续判断<br>                if (m%t == 0 || n%t == 0)<br>                {<br>                    break;<br>                }<br>            }<br>        }<br>        //如果循环结束的时候，n！&gt;=x或者m!&lt;=0则说明，这个偶数不满祝哥德巴赫的猜想<br>        if ( (!(n&gt;=x)) || (!(m&lt;=0)) )<br>        {<br>            printf(“%d不满足n”,x);<br>        }<br>    }<br>    //process compltet<br>    f = clock();<br>    printf(“%.3lf secondsn”, (double)(f - s)/CLOCKS_PER_SEC);<br>    return 0;<br>}<br>&nbsp;</p>
<p>但是，这个算法在我的电脑上大概需要跑7–9秒才可以证明完毕。所以就引出了如何优化的问题。</p>
<h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><p>我们看到，上面代码对于分解出来的每个因子x和y，判断质数都是从2开始，一直到√x或者√y，所以，这里就有了第一个优化方法：<strong>只判断奇数，即只用奇数去除待判断数字m或n。</strong></p>
<p><pre class="lang:c decode:true">//第一个循环，用来取出4——1000000之间的，所有偶数x<br>    for (; x &lt; 1000000; x+=2)<br>    {<br>        m = x / 2;<br>        n = m;<br>        R = m;<br>        //这个循环，用来对取出的偶数x的分解出的2个数做x/2次判断因为m和n变到0和x都需x/2次自减自加<br>        for (r = 0; r &lt; R; r++, m–, n++)<br>        {<br>            T = sqrt(n);<br>            //这个循环用来判断偶数x分解出的2个数m，n是否为质数，因为 n&gt;=m 恒成立，所以我们做sqrt(n)次判断<br>            for (t = 3; t &lt; T; t+=2)<br>            {<br>                //如果n和m中有一个数能够被大于2的整数i整除，则跳出这个for循环，对m，n变换后继续判断<br>                if (m%t == 0 || n%t == 0)<br>                {<br>                    break;<br>                }<br>            }<br>        }<br>        //如果循环结束的时候，n！&gt;=x或者m!&lt;=0则说明，这个偶数不满祝哥德巴赫的猜想<br>        if ( (!(n&gt;=x)) || (!(m&lt;=0)) )<br>        {<br>            printf(“%d不满足n”,x);<br>        }<br>    }</pre><br>&nbsp;</p>
<p>&nbsp;</p>
<p>其次呢，我们可以把判断<strong>x和y是否为质数中，大的那个数字，放到最内层循环，来减少CPU跨切循环层次数。</strong></p>
<p><pre class="lang:c decode:true">        T = sqrt(m);<br>        //首先判断m是否为质数，如果是质数，就进入到下个if块，判断n是否为质数<br>        //如果m不是质数，跳出#2，开始新一次#1，并对m–，n++，因为一个不满足，这一对就不满足<br>        for (t = 3; t &lt;= T; t += 2)     //#2<br>        {<br>            if (m%t == 0)<br>            {<br>                break;<br>            }<br>        }<br>        //得到了第一个质数m，我们再判断n是否为质数，是的话就跳出#1，不是的话，回到#2继续寻找下一个质数m<br>        if (t &gt; T)<br>        {<br>            n = x - m;<br>            T = sqrt(n);<br>            //判断n是否为质数。如果是，就执行下个if块，并跳出#1，回到#0，判断下一个偶数是否满足<br>            for (t = 3, T += 1; t &lt;=T; t += 2)     //#3<br>            {<br>                if (n%t == 0)<br>                {<br>                    break;<br>                }<br>            }<br>            if (t &gt; T)<br>            {<br>                TT = 0;<br>                //printf(“ %d+%d=%d”,n,m,x);<br>                continue;<br>            }<br>        }<br>        ++m, ++m;<br>        goto label;<br></pre><br>&nbsp;</p>
<p>再者，我们每次循环的过程中都要判断x%i==0，即x能否被i整除，在以上代码中，我们可以看到：每次判断x能被i整除后，我们用的是break语句，跳出这个循环，继续执行循环后的语句（即if块）。但是由于<strong>我们已经知道这个数不是质数。所以我们可以用一个goto语句，直接跳到顶部，改变x和y的值，继续判断。这样便去除了冗余的if判断。</strong></p>
<p>做完以上优化后，最终版本如下：</p>
<p><pre class="lang:c decode:true">/<em>/<br>第一组作品，by Kanch<br>算法优化参考了：<a href="http://m.blog.csdn.net/blog/sunjiajiang/7887724" target="_blank" rel="noopener">http://m.blog.csdn.net/blog/sunjiajiang/7887724</a><br>/</em>/</pre></p>
<p>#include&lt;stdio.h&gt;</p>
<p>#include&lt;time.h&gt;</p>
<p>#include&lt;math.h&gt;</p>
<p>int main()<br>{<br>    clock_t s, f;<br>    int x = 6, m, n, t = 2, T = 0, TT = 0;<br>    s = clock();<br>    //第一个循环，用来取出4——1000000之间的，所有偶数x<br>    for (; x &lt; 1000000; ++x,++x)     //#0<br>    {<br>        //这个循环，用来对取出的偶数x的分解出的2个数做x/2次判断因为m和n变到0和x都需x/2次自减自加<br>        //由于每次判断后，都要对m++,n–，所以，m+n=x<br>        m = 3;<br>    label_dm:</p>
<pre><code>    T = sqrt(m);
    //首先判断m是否为质数，如果是质数，就进入到下个if块，判断n是否为质数
    //如果m不是质数，跳出#2，开始新一次#1，并对m--，n++，因为一个不满足，这一对就不满足
    for (t = 3; t &amp;lt;= T; t += 2)     //#2
    {
        if (m%t == 0)
        {
            //break;
            ++m, ++m;
            goto label_dm;
        }
    }
    //得到了第一个质数m，我们再判断n是否为质数，是的话就跳出#1，不是的话，回到#2继续寻找下一个质数m
    if (t &amp;gt; T)
    {
        n = x - m;
        T = sqrt(n);
        //判断n是否为质数。如果是，就执行下个if块，并跳出#1，回到#0，判断下一个偶数是否满足
        for (t = 3, ++T; t &amp;lt;= T; t += 2)     //#3
        {
            if (n%t == 0)
            {
                break;
            }
        }
        if (t &amp;gt; T)
        {
            TT = 0;
            //printf(&quot; %d+%d=%d&quot;,n,m,x);
            continue;
        }
    }
    ++m, ++m;
    goto label_dm;

    //因为每次最外层循环开始前我都会把TT设置为1，这样，只要无法执行到51行，就说明这个偶数不满足哥德巴赫猜想啊
    if (TT)
    {
        printf(&quot;%d不满足n&quot;, x);
        TT = 1;
    }
}
f = clock();
printf(&quot;%.6lf secondsn&quot;, (double)(f - s) / CLOCKS_PER_SEC);
return 0;
</code></pre><p>}<br>&nbsp;</p>
<p>&lt;2015-11-5日更新，这里再补上一张算法解释图&gt;</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/11/gdbh.png" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/11/gdbh.png" alt="gdbh"></a></p>
<p>&nbsp;</p>
<p>&lt;kanch@20151103&gt;</p>
<p>&nbsp;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://akakanch.com/2015/10/19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kanch">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="akakanch">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/19/" itemprop="url">Windows下C++判断键盘上的方向键是否被按下</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-19T23:56:56+08:00">
                2015-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/" itemprop="url" rel="index">
                    <span itemprop="name">C++ / Visual C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;</p>
<p>我在使用C++做一个贪吃蛇程序的时候，卡在了如何利用C++判断方向键这里。</p>
<p>我原本想的是：直接用<span style="color: #ff00ff;">getch()</span>判断按下按键的ASCII码是否为方向键的。可是我在<a href="https://en.wikipedia.org/wiki/ASCII" target="_blank" rel="noopener">维基百科的ASCII页面</a>上并没有找到 <strong>↑ ↓ → ←</strong> 几个按键的ASCII码。<a href="http://bbs.csdn.net/topics/40312175" target="_blank" rel="noopener">在经过一番搜索后得到答案：http://bbs.csdn.net/topics/40312175</a>  答案如下：</p>
<p><pre class="lang:c++ decode:true ">#define VK_LEFT           0x25  //=37</pre></p>
<p>#define VK_UP             0x26  //=38</p>
<p>#define VK_RIGHT          0x27  //=39</p>
<p>#define VK_DOWN           0x28  //=40<br>然后我在我的程序里用<span style="color: #ff00ff;">switch</span>语句<span style="color: #ff00ff;"> case</span>了 37，38，39，40.然而却发现，在windows下，这样不可用。</p>
<p>按下相应按键后根本没有反应。</p>
<p>然后我想到了输出下<span style="color: #ff00ff;">getchar()</span>得到的值，结果令我大吃一惊，输出值如下：</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/10/C-_dectect_dir.png" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/10/C-_dectect_dir.png" alt="C++_dectect_dir"></a></p>
<p>&nbsp;</p>
<p>我们可以看到，每次按下方向键的时候，实际上是读入了2个数据，比如 <span style="color: #ff00ff;"><em>224n75</em></span>代表的是左方向键（←）。</p>
<p>所以有了以下这个方法：先判断第一个读入的数据，再用<span style="color: #ff00ff;">getchr()</span>得到一次，这次再用switch语句判断。代码如下：</p>
<p><pre class="lang:c++ decode:true ">//by Kanch<br>else if(kbdown == 224)<br>        {<br>            //pri-core code here<br>            //determine which action to perform<br>            kbdown = getch();    //due to  up/down/left/right no ASCII code,it print out as 224n75<br>            switch (kbdown)<br>            {<br>            case VK_LEFT:   //← pressed<br>                cout &lt;&lt; “left pressed” &lt;&lt; endl;<br>                break;<br>            case VK_UP:   //↑ pressed<br>                cout &lt;&lt; “up pressed” &lt;&lt; endl;<br>                break;<br>            case VK_RIGHT:   //→ pressed<br>                cout &lt;&lt; “right pressed” &lt;&lt; endl;<br>                break;<br>            case VK_DOWN:   //↓ pressed<br>                cout &lt;&lt; “down pressed” &lt;&lt; endl;<br>                break;<br>            default:<br>                break;<br>            }<br>        }</pre><br>&nbsp;</p>
<p>这样，我们便用C++实现了判断方向键是否被按下。</p>
<p><strong>&lt;转载请注明出处&gt;</strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://akakanch.com/2015/10/18/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kanch">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="akakanch">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/18/" itemprop="url">C++实现将文件二进位制作为字符串读出与写入字符串形式的二进制数据</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-18T23:29:56+08:00">
                2015-10-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/" itemprop="url" rel="index">
                    <span itemprop="name">C++ / Visual C++</span>
                  </a>
                </span>

                
                
                  . 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/算法、/" itemprop="url" rel="index">
                    <span itemprop="name">算法、</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文说明如何利用C++将文件的二进制数据，作为字符串读出。</p>
<p>文章末尾我给出了这个算法的C++完整实现。</p>
<p>并将给定字符串形式的二进制数据写入文件的一种可行方法。这个，不太好解释，举例吧：</p>
<p>将文件二进制位读出： 00010001011110001     #1</p>
<p>将 #1 的字符串形式二进制数据，再写入文件</p>
<p>一旦我们有了这个，对于一些小的文件，我们可以用来分析文件格式啥的。</p>
<hr>
<p>&nbsp;</p>
<h4 id="读取文件的二进制位"><a href="#读取文件的二进制位" class="headerlink" title="读取文件的二进制位"></a><span style="color: #ff0000;"><strong>读取文件的二进制位</strong></span></h4><p>首先将<span style="color: #000000;">读取</span>吧，C++这类语言都提供了按位运算符（&amp;，|，^），所以我们要用这个运算符。</p>
<p>对于所有文件，有一点我们是可以保证的，它的二进制位都是8的整数倍。</p>
<p>读取二进制的话，我们首先需要一个变量作为容器。这里我以 short 类型的变量作为读取容器。</p>
<p>当然，因为 short 类型的定义是no smaller than 16 bits，所以我们需要一个一个变量来储存是否有未读满的short类型。至于如何做，我建议在进行正式读取文件之前，我们再用fstream打开的时候将文件指针移动到文件尾部，最后利用fstream::tellg()得到它的位置L（单位byte），然后用sizeof得到当前环境下的short字节长度Z，最后取余（L%Z）得到的就是最后一个读入的short容器的空闲位（即没有读入文件数据的位数）.就像这样：</p>
<p>&nbsp;</p>
<pre class="lang:c++ decode:true">ifstream read(filepath, ios_base::binary | ios_base::in | ios_base::ate);  //open specfic file,then move pointer to the end of file
    int fileylen = read.tellg();   //tell  the len of the file (bytes)
    read.seekg(0, ios_base::beg);  //set pointer to the begining of the file</pre>
&nbsp;

文件IO的话，当然是用 fstream的 read()函数，将文件作为二进制打开。然后我们用一个循环不断的读取一个个short，然后做按位与运算。所以我们需要定义一个short数组，这个数组里面储存的元素都只有一个位为 1 ，且为1的位各不相同。就像这样：

&nbsp;
<pre class="lang:c++ decode:true ">short SV[16] = { short(0x1),short(0x2),short(0x4),short(0x8),
            short(0x10),short(0x20),short(0x40),short(0x80),
            short(0x100),short(0x200),short(0x400),short(0x800),
            short(0x1000),short(0x2000),short(0x4000),short(0x8000)
        };</pre>
每次我们从文件中读出一个short (sbuf)，就拿来把它的每一位和上面的SV数组的一个个元素做按位与运算，如下：
<pre class="lang:c++ decode:true ">for (int m = 0; m &lt; sizeof(short); m++)
            {
                if ((sbuf &amp; SV[m]) == SV[m])
                {
                    binBuf += "1";
                }
                else
                {
                    binBuf += "0";
                }
            }</pre>
要是该位为1的话，值自然不会变啦 xD

我们把每次读出的 0和1放入到binBuf这个string对象里面，最后输出就行了

* * *

&nbsp;

#### <span style="color: #ff0000;">**根据已有字符串形式的二进制数写入**</span>

接下来我们讲讲根据已有字符串形式的二进制数据，来恢复数据的过程。

很明显，读出数据的时候我们用的按位与运算，写入数据的时候我们自然就应该用按位或运算啦 xD

同读入部分，我们还是用一个short变量作为容器，只不过，每次操作完并将这个变量写入文件后，我们应该将这个缓冲变量的值设置为0（这样的话，它的每一位都未0）。

我们还是需要先确定给定的字符串形式二进制数据可以装满多少个short变量，仍然需要记录最后一个short变量的空闲位。

在写入的时候，每次用fstream::write()函数写入一个short值，再将缓冲short值设置为0，如此往复，直到全部写完，代码如下：
<pre class="lang:c++ decode:true ">for (int m = 0; m &lt; sizeof(short); m++)
                {
                    if (binBuf[m] == '1')   //now set the bit of short
                    {
                        sbuf = (sbuf | SV[m]);
                    }

                }
                write.write((char*)&amp;sbuf, sizeof(short));
                sbuf = 0;        //set all bits to 0</pre>

<hr>
<h4 id="读取顺序"><a href="#读取顺序" class="headerlink" title="读取顺序"></a><span style="color: #ff0000;"><strong>读取顺序</strong></span></h4><p>我这里提出的是使用 fstream的read()和write()函数来进行读取，如果读者使用我在后面提到的 fread()函数，请一定要配合fwrite()函数使用，配合 fstream::write()的话，可能会遇到意想不到的问题。</p>
<p>关于读取出来的二进制顺序，是这样的：</p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/10/C-_binary_read.png" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/10/C-_binary_read.png" alt="C++_binary_read"></a></p>
<hr>
<p>&nbsp;</p>
<h4 id="关于算法效率的问题"><a href="#关于算法效率的问题" class="headerlink" title="关于算法效率的问题"></a><span style="color: #ff0000;"><strong>关于算法效率的问题</strong></span></h4><p>但是这样的话如果我们用一个个short 类型作为容器，当文件大一点的时候，效率会很低。</p>
<p>所以，我们也可以使用 fopen()打开文件，然后用 fread()来读取文件，当然，如果这样的话，我们就需要用char数组作为一个缓冲区。我做个一个计算，fread()的效率，要远远大于fstream的read()。下面是我当时测试的时候用的数据：</p>
<p><span style="color: #808080;"><em>我用了fread()函数后，效率提高了好多，<wbr>内存占用量也少了好多。我用fread()<wbr>每次将数据从文件中读入一个12000字节的char缓冲区。输出的时间以毫秒为单位，以5.<wbr>47MB的jpg文件作为测试文件：之前的方法用了59s，内存峰值70+MB；改用fread()后用时16s，内存峰值8MB。</em></span></p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/10/C-_binary_2.png" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/10/C-_binary_2.png" alt="C++_binary_2"></a></p>
<p><a href="http://139.129.6.122/wp-content/uploads/2015/10/C-_binary_1.png" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/10/C-_binary_1.png" alt="C++_binary_1"></a></p>
<p>&nbsp;</p>
<p>除此之外，还可以利用多线程和C++内嵌汇编来提高效率。</p>
<p>所以，还请读者去我的GitHub页面，大家一起完成这个算法，让它效率更高 xD</p>
<hr>
<p><a href="https://github.com/ankanch/BinaryStringRW" target="_blank" rel="noopener">该算法（BinaryStringRW）的具体实现请访问我的GitHub页面：https://github.com/ankanch/BinaryStringRW</a></p>
<p><strong>&lt;转载请注明出处&gt;</strong></p>
<p>&nbsp;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://akakanch.com/2015/10/04/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kanch">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="akakanch">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/04/" itemprop="url">C++获取数组元素数目（数组长度）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-04T21:16:42+08:00">
                2015-10-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-Visual-C/" itemprop="url" rel="index">
                    <span itemprop="name">C++ / Visual C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>C++不像Java和C#，C++语言没有提供获得数组长度的函数，但是对于字符串，提供了strlen用来获取字</p>
<p>符串字符数目。但是对于其它类型的数组我们如何获取长度呢？</p>
<p>我们以一个整形数组为例：</p>
<p>int ia[10];</p>
<p><span style="color: #ff00ff;"><strong>int len = sizeof(ia)/ia[0];</strong></span></p>
<p>len即为该int数组ia的元素个数。</p>
<p>原因嘛是因为，sizeof(ia)是一个数组总共的字节数，而sizeof(ia[0])是一个元素占的字节数。所以相</p>
<p>除就是元素个数。</p>
<p>对此，我们可以利用c++的模版特性，写一个函数，可以用来获取任意类型数组的数组长度。代码如下：</p>
<p><pre class="lang:c++ decode:true ">template&lt;class T&gt;<br>int GetArrayLength(T &amp; array)<br>{<br>    return ( sizeof(array)/sizeof(array[0]) );<br>}</pre><br>注意：如果数组是new出来的，以上方法是无法使用的！需要这样：</p>
<p><span style="color: #ff00ff;"><strong>_msize(array)/sizeof(array[0]);</strong></span></p>
<p><a href="https://msdn.microsoft.com/en-us/library/aa298504?f=255&amp;MSPPError=-2147217396" target="_blank" rel="noopener">有关_msize,请访问MSDN查阅</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://akakanch.com/2015/10/04/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kanch">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="akakanch">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/04/" itemprop="url">利用VPS搭建shadowsocks服务器（转）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-04T17:42:02+08:00">
                2015-10-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux-Unix-虚拟主机-VPS/" itemprop="url" rel="index">
                    <span itemprop="name">Linux / Unix /虚拟主机 / VPS</span>
                  </a>
                </span>

                
                
                  . 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux-Unix-虚拟主机-VPS/翻墙相关-VPN/" itemprop="url" rel="index">
                    <span itemprop="name">翻墙相关 / VPN</span>
                  </a>
                </span>

                
                
                  . 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux-Unix-虚拟主机-VPS/翻墙相关-VPN/转载/" itemprop="url" rel="index">
                    <span itemprop="name">转载</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;</p>
<p>继红杏出墙，时空隧道等一系列著名翻墙插件被封杀后，翻墙方式也越来越少。但对于博主这种重度谷歌用户，怎能屈服于GFW呢。</p>
<h3 id="shadowsocks简介（搬运至互联网）"><a href="#shadowsocks简介（搬运至互联网）" class="headerlink" title="shadowsocks简介（搬运至互联网）"></a><strong>shadowsocks简介（搬运至互联网）</strong></h3><p>shadowsocks是一款自定义协议的代理软件，由于其流量特征不明显，（直到不久前）一直可以稳定提供上网代理。shadowsocks客户端会在本地开启一个socks5代理，通过此代理的网络访问请求由客户端发送至服务端，服务端发出请求，收到响应数据后再发回客户端。因此使用shadowsocks需要一台墙外的服务器来部署shadowsocks服务端。</p>
<p>再来谈谈VPS服务器的问题吧，博主用的<strong><a href="https://www.budgetvm.com/account/aff.php?aff=3228" target="_blank" rel="noopener">BudgetVM</a></strong>的，用了1年多了，感觉还不错，同时呢，网上还给出了其它的VPS服务提供商，比较著名的还有<a href="http://welcome.linode.com/features/?gclid=Cj0KEQjwnMOwBRCAhp-ysqCwypkBEiQAeSy1-basvgxVbtZ7mjtO5aY6BIm307OZrahN_rZLd-bzZ8caAji68P8HAQ" target="_blank" rel="noopener">Linode</a>和<a href="https://www.digitalocean.com/?utm_source=google&amp;utm_medium=brand_sem&amp;utm_campaign=Brand_Protection&amp;utm_term=digital%20ocean&amp;adgroup=9971414725&amp;matchtype=e&amp;network=g&amp;device=c&amp;position=1t1" target="_blank" rel="noopener">Digital Ocean</a>，至于它们各自的易用性，还是读者自己每个都买一年试试吧。</p>
<hr>
<p>&nbsp;</p>
<h3 id="接下来进入在VPS上部署Shadowsocks服务器正题"><a href="#接下来进入在VPS上部署Shadowsocks服务器正题" class="headerlink" title="接下来进入在VPS上部署Shadowsocks服务器正题"></a><strong>接下来进入在VPS上部署Shadowsocks服务器正题</strong></h3><p>首先肯定要登陆你的VPS，登陆后按照以下命令，来安装和启动服务。</p>
<p>（PS，我用的CentOS6 32bit）</p>
<hr>
<p>&nbsp;</p>
<h5 id="安装shadowsocks"><a href="#安装shadowsocks" class="headerlink" title="安装shadowsocks"></a><strong>安装shadowsocks</strong></h5><p>&nbsp;</p>
<p>打开shell，使用VPS服务商提供的root用户和密码SSH登录VPS。然后执行如下命令：</p>
<hr>
<p>&nbsp;</p>
<h6 id="Debian-Ubuntu"><a href="#Debian-Ubuntu" class="headerlink" title="Debian/Ubuntu:"></a><strong>Debian/Ubuntu:</strong></h6><p><span style="color: #ff00ff;">apt-get install python-pip</span><br><span style="color: #ff00ff;">pip install shadowsocks</span></p>
<p><span style="color: #ff0000;"><em>请选择对应系统的命令</em></span></p>
<h6 id="CentOS"><a href="#CentOS" class="headerlink" title="CentOS:"></a><strong>CentOS:</strong></h6><p><span style="color: #ff00ff;">yum install python-setuptools &amp;&amp; easy_install pip</span><br><span style="color: #ff00ff;">pip install shadowsocks</span></p>
<hr>
<p>命令输入后，稍作等待，shadowsocks就安装好了。</p>
<p>有时Ubuntu会遇到第一个命令安装python-pip时找不到包的情况。pip官方给出了一个安装脚本，可以自</p>
<p>动安装pip。先下载脚本，然后执行即可：</p>
<p><span style="color: #ff00ff;">wget <a href="https://bootstrap.pypa.io/get-pip.py" target="_blank" rel="noopener">https://bootstrap.pypa.io/get-pip.py</a></span><br><span style="color: #ff00ff;">python get-pip.py</span></p>
<hr>
<h4 id="接下来，编写配置文件"><a href="#接下来，编写配置文件" class="headerlink" title="接下来，编写配置文件"></a><strong>接下来，编写配置文件</strong></h4><p>&nbsp;</p>
<p>shadowsocks启动时的参数，如服务器端口，代理端口，登录密码等，可以通过启动时的命令行参数来设</p>
<p>定，也可以通过json格式的配置文件设定。推荐使用配置文件，方便查看和修改。</p>
<p>用vi新建一个配置文件：</p>
<p><span style="color: #ff00ff;">vi /etc/shadowsocks.json</span><br>然后输入如下内容：</p>
<p><span style="color: #ff99cc;">{ </span><br><span style="color: #ff99cc;"> “server”:”my_server_ip”, </span><br><span style="color: #ff99cc;"> “server_port”:25, </span><br><span style="color: #ff99cc;"> “local_address”: “127.0.0.1”, </span><br><span style="color: #ff99cc;"> “local_port”:1080, </span><br><span style="color: #ff99cc;"> “password”:”mypassword”,</span><br><span style="color: #ff99cc;"> “timeout”:300, </span><br><span style="color: #ff99cc;"> “method”:”aes-256-cfb”, </span><br><span style="color: #ff99cc;"> “fast_open”: false</span><br><span style="color: #ff99cc;">}</span></p>
<p>server改成你VPS服务器的IP地址！<br>使用 <span style="color: #ff00ff;">:wq </span>命令保存退出。</p>
<hr>
<p>&nbsp;</p>
<h4 id="启动shadowsocks"><a href="#启动shadowsocks" class="headerlink" title="启动shadowsocks"></a><strong>启动shadowsocks</strong></h4><p>&nbsp;</p>
<p>如果已经写好了配置文件，启动shadowsocks服务器的命令如下：</p>
<p><span style="color: #ff00ff;">ssserver -c /etc/shadowsocks.json</span><br>后台启动和停止shadowsocks服务器：</p>
<p><span style="color: #ff00ff;">ssserver -c /etc/shadowsocks.json -d start</span><br><span style="color: #ff00ff;">ssserver -c /etc/shadowsocks.json -d stop</span><br>shadowsocks的日志保存在 /var/log/shadowsocks.log</p>
<hr>
<p>&nbsp;</p>
<h4 id="安装并启动shadowsocks客户端"><a href="#安装并启动shadowsocks客户端" class="headerlink" title="安装并启动shadowsocks客户端"></a><strong>安装并启动shadowsocks客户端</strong></h4><p>shadowsocks支持windows、Mac OS X、Linux、Android、iOS等多个平台。</p>
<p><a href="https://s-s.pw/" target="_blank" rel="noopener">Shadowsocks客户端下载，个平台使用教程，请看这里：</a></p>
<p><a href="https://s-s.pw/" target="_blank" rel="noopener">https://s-s.pw/</a></p>
<p>下载安装客户端以后，只需按服务器的配置填写IP地址、服务器端口、本地端口（如果没有本地端口选</p>
<p>项，就是默认的1080）、密码、加密方式等参数，启动就可以了。</p>
<p><span style="line-height: 1.5;"><a href="http://139.129.6.122/wp-content/uploads/2015/10/SSsetsd.png" target="_blank" rel="noopener"><img src="http://139.129.6.122/wp-content/uploads/2015/10/SSsetsd.png" alt="SSsetsd"></a></span></p>
<p><span style="line-height: 1.5;">客户端支持全局代理和PAC代理两种方式，后者会使用一个脚本来自动检查一个网站是否在需要代理的网</span></p>
<p>站列表中，自动选择直接连接或代理连接。</p>
<p>PAC列表可以在线更新（地址：<a href="https://autoproxy-gfwlist.googlecode.com/svn/trunk/gfwlist.txt" target="_blank" rel="noopener">https://autoproxy-gfwlist.googlecode.com/svn/trunk/gfwlist.txt</a>）</p>
<p>&nbsp;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Kanch</p>
              <p class="site-description motion-element" itemprop="description">personal blog of Long Zhang (kanchisme@gmail.com)</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">75</span>
                  <span class="site-state-item-name">Artikel</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">25</span>
                  <span class="site-state-item-name">Kategorien</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">282</span>
                  <span class="site-state-item-name">Tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Kanch</span>

  
</div>


  <div class="powered-by">Erstellt mit  <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
