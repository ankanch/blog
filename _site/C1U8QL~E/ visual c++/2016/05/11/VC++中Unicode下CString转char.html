<h1 id="vc中unicode下cstring转char">VC++中Unicode下CString转char</h1>

<p>在进行数据库编程的过程中，需要把_variant_t类型转换成char_尝试了各种方法，最后发现把他转换成CString，再有CString转换成char_比较简单。</p>

<p>这里我们说的利用宏T2A和W2A进行转换。</p>

<p>顾名思义，T2A是从wchar_t_到char_的转换；W2A是由宽字符到ANSI字符之间的转换。</p>

<p>转换方式如下，首先需要声明标识符：USES_CONVERSION，然后我们在利用这2个宏进行数据类型转换</p>

<p>代码如下：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//UNICODE下的CString转char* USES_CONVERSION; strcpy_s(tsc.staname,W2A((LPCTSTR)vname.lVal)); strcpy_s(tsc.parentline, W2A((LPCTSTR)vparent.lVal));
W2A((LPCTSTR)vname.lVal);
</code></pre></div></div>

<p>USES_CONVERSION;</p>

<p>CString cstr = _T(“12345”); char <em>pbuffer = T2A(cstr);<br />
char</em> pbuf = W2A(cstr);&lt;/pre&gt;  </p>

